server {
    listen 80; # Nginx escuta na porta 80 dentro do contêiner
    server_name localhost; # Pode ser ajustado para seu domínio em produção

    # Define o diretório raiz para os arquivos da sua aplicação React
    # Este é o diretório onde os arquivos de build do React são copiados
    # No seu Dockerfile do frontend, você copia para /usr/share/nginx/html, então use isso.
    root /usr/share/nginx/html;

    # Arquivo padrão a ser servido
    index index.html index.htm;

    # Essa é a configuração chave para SPAs
    location / {
        try_files $uri $uri/ /index.html;
        # Tenta servir:
        # 1. O URI solicitado ($uri)
        # 2. O URI como um diretório ($uri/, ex: /build/ -> /build/index.html)
        # 3. Se nada for encontrado, serve /index.html
    }

    # Opcional: Configuração de proxy para o backend (Django)
    # Se seu frontend faz requisições para /api/ ou /admin/, elas precisam ser encaminhadas para o backend.
    # O nome 'backend' é o nome do serviço no seu docker-compose.yml
    location /api/ {
        proxy_pass http://backend:8000;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    }
    location /admin/ {
        proxy_pass http://backend:8000;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    }
}